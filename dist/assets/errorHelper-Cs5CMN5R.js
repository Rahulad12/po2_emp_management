import{r as n,A as d}from"./constant-DWVoamgU.js";const u=async(s,e,t)=>{if(!e||!t)return n(!1,"Please enter both email and password");try{if((await(await fetch(s)).json()).some(i=>i.email===e))return n(!1,"User already exists");const c=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}),l=await c.json();return c.ok?n(!0,{user:l.id,message:"Registration Successful"}):n(!1,l.message)}catch(r){return n(!1,r.message)}},m=async(s,e,t)=>{if(!e||!t)return n(!1,"Please enter both email and password");try{const a=(await(await fetch(s)).json()).find(c=>c.email===e);return a?a.password!==t?n(!1,"Invalid Credentials"):n(!0,{user:a.id,message:"Login Successful"}):n(!1,"User not found")}catch(r){return n(!1,r.message)}},p=async(s,e)=>{try{const r=await(await fetch(`${s}/${e}`)).json();return r?n(!0,r):n(!1,"User not found")}catch(t){return n(!1,t.message)}},g=async(s,e,t,r)=>{try{const a=await(await fetch(`${s}/${e}`)).json();if(!a)return n(!1,"User not found");if(a.password!==r)return console.log("current password"),n(!1,"Current password is incorrect");if(a.password===t)return n(!1,"New password cannot be the same as the old password");a.password=t;const l=await(await fetch(`${s}/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).json();return n(!0,{user:l.id,message:"Password changed successfully"})}catch(o){return n(!1,o.message)}},y=async(s,e,t)=>{try{const o=await(await fetch(`${s}/${e}`)).json();if(!o)return n(!1,"User not found");if(o.email===t)return n(!1,"New email cannot be the same as the old email");o.email=t;const c=await(await fetch(`${s}/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})).json();return n(!0,{user:c.id,message:"Email changed successfully"})}catch{}},f=async(s,e)=>await u(d,s,e),h=async(s,e)=>await m(d,s,e),E=async s=>await p(d,s),I=async(s,e,t)=>await g(d,s,e,t),B=async(s,e)=>await y(d,s,e),b=()=>{const s=document.getElementById("form"),e=document.getElementById("email"),t=document.getElementById("password"),r=document.getElementById("submit-button");return{authForm:s,emailInput:e,passwordInput:t,submitButton:r}},P=(...s)=>(s.forEach(e=>{e.value=""}),s),U=()=>{const s=document.getElementById("change-password-form"),e=document.getElementById("old-password"),t=document.getElementById("new-password"),r=document.getElementById("confirm-password"),o=document.getElementById("change-password-btn");return{changePasswordForm:s,oldPasswordInput:e,newPasswordInput:t,confirmPasswordInput:r,changePasswordButton:o}},j=()=>{const s=document.getElementById("change-email-form"),e=document.getElementById("email"),t=document.getElementById("change-email-btn");return{changeEmailForm:s,newEmailInput:e,changeEmailButton:t}},C=()=>!!localStorage.getItem("token"),k=s=>{const e=document.getElementById("password-error-message");e.textContent=s,e.style.color="red",e.style.display=s?"block":"none"},x=s=>{const e=document.getElementById("email-error-message");e.textContent=s,e.style.color="red",e.style.display=s?"block":"none"},$=s=>{const e=document.getElementById("error-message");e.textContent=s.message,e.style.color=s.success?"green":"red",e.style.display=s.message?"block":"none"},M=s=>{const e=document.getElementById("old-password-error-message");e.textContent=s,e.style.color="red",e.style.display=s?"block":"none"},A=s=>{const e=document.getElementById("new-password-error-message");e.textContent=s,e.style.color="red",e.style.display=s?"block":"none"},R=s=>{const e=document.getElementById("confirm-password-error-message");e.textContent=s,e.style.color="red",e.style.display=s?"block":"none"},S=s=>{const e=document.getElementById("change-email-error-message");e.textContent=s,e.style.color=s=="Email changed successfully"?"green":"red",e.style.display=s?"block":"none"};export{b as a,x as b,f as c,j as d,$ as e,S as f,E as g,U as h,C as i,I as j,R as k,h as l,A as n,M as o,k as p,P as r,B as u};
